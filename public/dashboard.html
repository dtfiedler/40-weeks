<!DOCTYPE html>
<html>
<head>
	<title>Dashboard</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<style>
		/* Shadcn-inspired custom styles */
		:root {
			--background: 0 0% 100%;
			--foreground: 240 10% 3.9%;
			--card: 0 0% 100%;
			--card-foreground: 240 10% 3.9%;
			--popover: 0 0% 100%;
			--popover-foreground: 240 10% 3.9%;
			--primary: 240 5.9% 10%;
			--primary-foreground: 0 0% 98%;
			--secondary: 240 4.8% 95.9%;
			--secondary-foreground: 240 5.9% 10%;
			--muted: 240 4.8% 95.9%;
			--muted-foreground: 240 3.8% 46.1%;
			--accent: 240 4.8% 95.9%;
			--accent-foreground: 240 5.9% 10%;
			--destructive: 0 84.2% 60.2%;
			--destructive-foreground: 0 0% 98%;
			--border: 240 5.9% 90%;
			--input: 240 5.9% 90%;
			--ring: 240 10% 3.9%;
			--radius: 0.5rem;
		}
		
		body {
			font-family: 'Inter', sans-serif;
		}
		
		.card {
			background-color: hsl(var(--card));
			color: hsl(var(--card-foreground));
			border-radius: var(--radius);
			border: 1px solid hsl(var(--border));
			box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
		}
		
		.btn-destructive {
			background-color: hsl(var(--destructive));
			color: hsl(var(--destructive-foreground));
		}
		
		.btn-destructive:hover {
			background-color: hsl(var(--destructive) / 0.9);
		}
	</style>
</head>
<body class="bg-gray-50">
	<div class="min-h-screen">
		<!-- Header -->
		<header class="bg-white border-b border-gray-200 sticky top-0 z-10">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<div class="flex justify-between items-center h-16">
					<h1 class="text-xl font-semibold text-gray-900">Dashboard</h1>
					<button onclick="logout()" class="btn-destructive px-4 py-2 rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
						Sign out
					</button>
				</div>
			</div>
		</header>

		<!-- Main Content -->
		<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
			<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
				<!-- Profile Card -->
				<div class="card p-6">
					<div class="flex items-center justify-between mb-4">
						<h2 class="text-lg font-semibold text-gray-900">Profile Information</h2>
						<svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
						</svg>
					</div>
					<div id="profile-info" class="space-y-3">
						<div class="animate-pulse">
							<div class="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
							<div class="h-4 bg-gray-200 rounded w-1/2"></div>
						</div>
					</div>
				</div>

				<!-- Users Card -->
				<div class="card p-6">
					<div class="flex items-center justify-between mb-4">
						<h2 class="text-lg font-semibold text-gray-900">Active Users</h2>
						<svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
						</svg>
					</div>
					<div id="users-info" class="space-y-2">
						<div class="animate-pulse space-y-2">
							<div class="h-4 bg-gray-200 rounded"></div>
							<div class="h-4 bg-gray-200 rounded"></div>
						</div>
					</div>
				</div>

				<!-- Stats Cards -->
				<div class="card p-6">
					<div class="flex items-center justify-between mb-2">
						<h3 class="text-sm font-medium text-gray-500">Total Sessions</h3>
						<svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
						</svg>
					</div>
					<p class="text-2xl font-bold text-gray-900" id="session-count">1</p>
					<p class="text-xs text-gray-500 mt-1">Active now</p>
				</div>

				<div class="card p-6">
					<div class="flex items-center justify-between mb-2">
						<h3 class="text-sm font-medium text-gray-500">API Status</h3>
						<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
						</svg>
					</div>
					<p class="text-2xl font-bold text-gray-900">Healthy</p>
					<p class="text-xs text-gray-500 mt-1">All systems operational</p>
				</div>
			</div>
		</main>
	</div>
	
	<script>
		const token = localStorage.getItem('jwt_token');
		
		if (!token) {
			window.location.href = '/login';
		}
		
		async function fetchWithAuth(url) {
			const response = await fetch(url, {
				headers: {
					'Authorization': 'Bearer ' + token
				}
			});
			
			if (response.status === 401) {
				localStorage.removeItem('jwt_token');
				window.location.href = '/login';
				return null;
			}
			
			return response.json();
		}
		
		async function loadProfile() {
			const data = await fetchWithAuth('/api/profile');
			if (data) {
				document.getElementById('profile-info').innerHTML = `
					<div class="space-y-3">
						<div class="flex justify-between items-center py-2 border-b border-gray-100">
							<span class="text-sm text-gray-500">Username</span>
							<span class="text-sm font-medium text-gray-900">${data.username}</span>
						</div>
						${data.email ? `
						<div class="flex justify-between items-center py-2 border-b border-gray-100">
							<span class="text-sm text-gray-500">Email</span>
							<span class="text-sm font-medium text-gray-900">${data.email}</span>
						</div>
						` : ''}
						<div class="flex justify-between items-center py-2">
							<span class="text-sm text-gray-500">Status</span>
							<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
								Active
							</span>
						</div>
					</div>
				`;
			}
		}
		
		async function loadUsers() {
			const data = await fetchWithAuth('/api/users');
			if (data && data.users) {
				const usersHtml = data.users.map(user => `
					<div class="flex items-center justify-between p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors">
						<div class="flex items-center space-x-3">
							<div class="flex-shrink-0 w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center">
								<span class="text-xs font-medium text-gray-600">${user.name.charAt(0)}</span>
							</div>
							<div>
								<p class="text-sm font-medium text-gray-900">${user.name}</p>
								<p class="text-xs text-gray-500">ID: ${user.id}</p>
							</div>
						</div>
						<span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-700">
							User
						</span>
					</div>
				`).join('');
				document.getElementById('users-info').innerHTML = usersHtml;
			}
		}
		
		function logout() {
			localStorage.removeItem('jwt_token');
			window.location.href = '/login';
		}
		
		// Load data on page load
		loadProfile();
		loadUsers();
		
		// Update session count
		let sessionCount = 1;
		setInterval(() => {
			sessionCount = Math.max(1, sessionCount + Math.floor(Math.random() * 3) - 1);
			document.getElementById('session-count').textContent = sessionCount;
		}, 5000);
	</script>
</body>
</html>